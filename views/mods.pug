extends ui_layout
block content
  -var cdn = "https://dhpd030vnpk29.cloudfront.net";
  -var path = isResearchVersion ? 'intro' : 'guest';

  .ui.grid
    .row#blue-upper
      .sixteen.wide.column
        .ui.container
          if user.profile.name != "Guest"
            h1.ui.header.center.aligned Welcome back #{user.profile.name} !
          else 
            h1.ui.header.center.aligned Welcome!
          .limit(style="padding-bottom: 40px; text-align: center;")
            p#about What would you like to learn today?
    .row#white-lower
      .sixteen.wide.column
        .ui.container
          .limit(style="padding-bottom: 40px;")
            h2.ui.header#in-progress Courses:
            a.ui#theft-link(href=`/intro/identity` alt="Begin identity theft module")
              .ui.raised.segment
                .ui.fluid.container(style="height: 200px;")
                  .ui.image.banner
                    img(src="/images/identity-theft-banner.jpg", alt="Identity Theft Banner Image")

                    #theft-progress.ui.bottom.attatched.small.progress(style='margin:0;padding:0;' data-percent='33')
                      .bar(style='border-radius: 0 !important;')
                        .progress
                #raised-content(style="padding-top: 20px;")
                  h3.ui.header.large.home-mod-title
                    | Identity Theft
                  p(style="color:black") Understand the consequences of identity theft and learn how to identify and take action against phishing scams on social media.
                  button.ui.huge.blue.button.right.floated#nextButton
                    | Learn Now
                    i.arrow.right.icon
          .ui.basic.segment(style="text-align: center; margin-top: -15px;")
            button.ui.center.aligned.huge.basic.button#reset-progress(onclick="localStorage.setItem('progress', 0); localStorage.setItem('theft-path', 'intro/identity'); location.reload();") Reset Identity Theft Progress

block styles
  link(rel='stylesheet', href='/css/mods.css')

block scripts
  script.
    let theftPath = localStorage.getItem('theft-path');
    console.log("theftPath is: " + theftPath);
    if (theftPath === null) {
    } else {
      console.log("change link");
      const link = document.getElementById('theft-link');
      link.setAttribute('href', theftPath);
    }

    // Check if the "progress" variable has been assigned a value yet
    let progress = localStorage.getItem('progress');
    if (progress === null) {
      // If the variable has not been assigned yet, set it to 0
      progress = 0;
      localStorage.setItem('progress', progress);
    } else {
      // If the variable has been assigned, parse the value from local storage
      progress = parseInt(progress);
    }
    console.log("Progress is: " + progress);

    const progressBar = document.getElementById('theft-progress');
    if (progressBar) {
      progressBar.setAttribute('data-percent', progress);
      progressBar.querySelector('.bar').style.width = progress + "%";
      if(progress > 0 && progress < 100){
        progressBar.querySelector('.bar').style.backgroundColor = '#6BBCC7';
      } else if(progress == 100) {
        progressBar.querySelector('.bar').style.backgroundColor = 'blue';
      }
      progressBar.querySelector('.progress').textContent = progress + "%";
    } else {
      console.error('Could not find progress bar element');
    }
        
            